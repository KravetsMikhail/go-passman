<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>go-passman ‚Äî List</title>
  <style>
    * { box-sizing: border-box; }
    body { font-family: system-ui, sans-serif; max-width: 900px; margin: 1rem auto; padding: 0 1rem; }
    h1 { font-size: 1.25rem; }
    a { color: #0d6efd; text-decoration: none; }
    a:hover { text-decoration: underline; }
    table { width: 100%; border-collapse: collapse; }
    th, td { text-align: left; padding: 0.5rem; border-bottom: 1px solid #dee2e6; }
    th { font-weight: 600; }
    .actions { margin: 1rem 0; }
    .btn { display: inline-block; padding: 0.4rem 0.8rem; background: #0d6efd; color: #fff; border: none; border-radius: 4px; cursor: pointer; font-size: 0.9rem; text-decoration: none; }
    .btn:hover { background: #0b5ed7; }
    .btn-secondary { background: #6c757d; }
    .btn-secondary:hover { background: #5c636a; }
    .btn-danger { background: #dc3545; }
    .btn-danger:hover { background: #bb2d3b; }
    .btn-sm { padding: 0.2rem 0.5rem; font-size: 0.85rem; margin-right: 0.25rem; }
    .btn-icon { display: inline-flex; align-items: center; justify-content: center; width: 28px; height: 28px; padding: 0; margin-right: 0.25rem; border-radius: 4px; }
    .btn-icon svg { width: 16px; height: 16px; }
    .btn-icon:hover { opacity: 0.9; }
    .muted { color: #6c757d; font-size: 0.9rem; }
    .pagination { margin-top: 1rem; display: flex; align-items: center; gap: 0.5rem; flex-wrap: wrap; }
    .pagination a, .pagination span { padding: 0.3rem 0.6rem; }
    .pagination .current { font-weight: 600; }
  </style>
</head>
<body>
  <h1>üîê go-passman</h1>
  <p class="muted">Found {{.TotalFiltered}}{{if .Query}} of {{.Total}}{{end}} entries</p>
  <div class="actions">
    <form class="search-form" method="get" action="/" style="display: inline-block; margin-right: 1rem;">
      <input type="search" name="q" id="search" value="{{.Query}}" placeholder="Search all fields‚Ä¶" autocomplete="off" style="padding: 0.4rem 0.6rem; width: 220px; border: 1px solid #dee2e6; border-radius: 4px;">
      <input type="hidden" name="page" value="1">
    </form>
    <a class="btn" href="/add">+ Add</a>
    <a class="btn btn-secondary" href="/logout">Lock</a>
  </div>
  <table>
    <thead>
      <tr>
        <th>#</th>
        <th>Service</th>
        <th>Login</th>
        <th>Host</th>
        <th>Comment</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {{range .Entries}}
      <tr>
        <td>{{.Num}}</td>
        <td>{{.Name}}</td>
        <td>{{.Login}}</td>
        <td>{{.Host}}</td>
        <td>{{.Comment}}</td>
        <td>
          <a class="btn btn-sm btn-icon" href="/show?name={{urlquery .Name}}" title="Show password"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg></a>
          <a class="btn btn-sm btn-icon" href="/edit?name={{urlquery .Name}}" title="Edit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/></svg></a>
          <a class="btn btn-sm btn-icon btn-danger" href="/delete?name={{urlquery .Name}}" title="Delete"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg></a>
        </td>
      </tr>
      {{end}}
    </tbody>
  </table>
  {{if eq .TotalFiltered 0}}
  <p class="muted">No entries yet. <a href="/add">Add the first one</a>.{{if .Query}} No matches for "{{.Query}}".{{end}}</p>
  {{end}}
  {{if gt .TotalPages 1}}
  <nav class="pagination">
    {{if gt .Page 1}}
    <a class="btn btn-sm" href="/?q={{urlquery .Query}}&page={{sub .Page 1}}">‚Üê Prev</a>
    {{end}}
    {{$q := .Query}}{{$p := .Page}}{{$tp := .TotalPages}}
    {{range $i := iterate 1 $tp}}
      {{if eq $i $p}}<span class="current">{{$i}}</span>{{else}}<a href="/?q={{urlquery $q}}&page={{$i}}">{{$i}}</a>{{end}}
    {{end}}
    {{if lt .Page .TotalPages}}
    <a class="btn btn-sm" href="/?q={{urlquery .Query}}&page={{add .Page 1}}">Next ‚Üí</a>
    {{end}}
  </nav>
  {{end}}
  <script>
    (function(){
      var form = document.querySelector('.search-form');
      var input = document.getElementById('search');
      var timer;
      input.addEventListener('input', function(){
        clearTimeout(timer);
        timer = setTimeout(function(){ form.submit(); }, 280);
      });
      if (input.value) {
        input.focus();
        input.setSelectionRange(input.value.length, input.value.length);
      }
    })();
  </script>
</body>
</html>
